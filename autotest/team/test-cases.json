{
  "meta": {
    "description": "Test cases for /multimodel:team command orchestration. Verifies correct model invocation: internal via Task({resolved_agent}), external via Bash(claudish). Tests dynamic agent routing, parallel launch, session dir, vote template, no pre-digestion, and model verification.",
    "version": "2.2.0",
    "created": "2026-02-11",
    "notes": "v2.2.0: Dynamic agent routing — task keywords determine subagent_type from context_detection table. Review→agentdev:reviewer, debug→dev:debugger, architecture→dev:architect. Default: dev:researcher."
  },
  "model_aliases": {
    "grok": "grok-code-fast-1",
    "gemini": "gemini-3-pro-preview",
    "gpt-5": "gpt-5.2-codex",
    "deepseek": "deepseek-v3.2",
    "minimax": "minimax-m2.5",
    "glm": "glm-4.7"
  },
  "test_cases": [
    {
      "id": "team-agent-internal",
      "description": "Internal-only model should use Task with dynamically resolved agent, no Bash claudish",
      "prompt": "/multimodel:team --models internal --no-memory Review the plugin.json structure in the dev plugin",
      "checks": {
        "task_agent_is": "agentdev:reviewer",
        "task_min_count": 1,
        "no_proxy_mode_in_tasks": true,
        "has_vote_template": true
      },
      "tags": ["agent-selection", "internal", "agent-routing"]
    },
    {
      "id": "team-agent-external",
      "description": "External model should use Bash+claudish (not Task with PROXY_MODE)",
      "prompt": "/multimodel:team --models grok --no-memory Review the plugin.json structure in the dev plugin",
      "checks": {
        "bash_has_claudish": true,
        "bash_claudish_model_contains": "grok",

        "bash_claudish_has_stdin": true,
        "no_proxy_mode_in_tasks": true
      },
      "tags": ["agent-selection", "external", "bash-claudish"]
    },
    {
      "id": "team-parallel-mixed",
      "description": "Mixed internal+external: internal=Task, external=Bash+claudish, all parallel",
      "prompt": "/multimodel:team --models internal,grok --no-memory Check if CLAUDE.md has proper formatting",
      "checks": {
        "internal_uses_task": true,
        "external_uses_bash": true,
        "bash_has_claudish": true,
        "task_agent_is": "agentdev:reviewer",
        "bash_run_in_background": true,
        "run_in_background": true
      },
      "tags": ["parallel", "mixed-models", "agent-routing"]
    },
    {
      "id": "team-no-predigest",
      "description": "Investigation task should NOT be pre-solved by orchestrator",
      "prompt": "/multimodel:team --models internal --no-memory Investigate how the conductor plugin orchestration patterns work and document the key design decisions",
      "checks": {
        "task_agent_is": "dev:researcher",
        "no_predigest": true
      },
      "tags": ["no-predigest"]
    },
    {
      "id": "team-session-dir",
      "description": "Session directory should be under ai-docs/sessions/",
      "prompt": "/multimodel:team --models internal --no-memory Quick check on README formatting",
      "checks": {
        "session_dir_pattern": "ai-docs/sessions/",
        "no_tmp_dir": true
      },
      "tags": ["session-dir"]
    },
    {
      "id": "team-multi-external",
      "description": "Multiple external models should all use Bash+claudish with correct model IDs",
      "prompt": "/multimodel:team --models grok,gemini --no-memory Review the multimodel plugin structure",
      "checks": {
        "bash_has_claudish": true,
        "bash_min_count": 2,

        "bash_claudish_has_stdin": true,
        "bash_run_in_background": true,
        "no_proxy_mode_in_tasks": true,
        "no_proxy_mode_in_bash": true
      },
      "tags": ["multi-external", "bash-claudish"]
    },
    {
      "id": "team-model-alias-grok",
      "description": "Alias 'grok' should resolve to model containing 'grok' in Bash claudish command",
      "prompt": "/multimodel:team --models grok --no-memory Check plugin version numbers",
      "checks": {
        "bash_claudish_model_contains": "grok",
        "bash_has_claudish": true,
        "no_provider_prefix_in_model": true
      },
      "tags": ["model-alias", "no-prefix"]
    },
    {
      "id": "team-model-alias-gemini",
      "description": "Alias 'gemini' should resolve to model containing 'gemini' in Bash claudish command",
      "prompt": "/multimodel:team --models gemini --no-memory Check plugin version numbers",
      "checks": {
        "bash_claudish_model_contains": "gemini",
        "bash_has_claudish": true,
        "no_provider_prefix_in_model": true
      },
      "tags": ["model-alias", "no-prefix"]
    },
    {
      "id": "team-vote-template",
      "description": "Internal Task prompts should contain the vote template with required format",
      "prompt": "/multimodel:team --models internal --no-memory Evaluate if the README has all required sections",
      "checks": {
        "has_vote_template": true,
        "has_vote_format": true,
        "task_agent_is": "dev:researcher"
      },
      "tags": ["vote-template"]
    },
    {
      "id": "team-background-launch",
      "description": "All model calls (Task and Bash) should use run_in_background for parallel execution",
      "prompt": "/multimodel:team --models internal,grok --no-memory Review code quality of plugin.json files",
      "checks": {
        "run_in_background": true,
        "bash_run_in_background": true,
        "task_agent_is": "agentdev:reviewer"
      },
      "tags": ["parallel", "background", "agent-routing"]
    },
    {
      "id": "team-bash-claudish-flags",
      "description": "Claudish Bash command should have all required flags: --stdin, --quiet, output redirect",
      "prompt": "/multimodel:team --models grok --no-memory Quick review of README",
      "checks": {
        "bash_has_claudish": true,

        "bash_claudish_has_stdin": true,
        "bash_claudish_has_output_redirect": true
      },
      "tags": ["bash-claudish", "flags"]
    },
    {
      "id": "team-exit-code-capture",
      "description": "Bash claudish command should capture exit code to .exit file",
      "prompt": "/multimodel:team --models grok --no-memory Check formatting of CLAUDE.md",
      "checks": {
        "bash_has_claudish": true,
        "bash_claudish_captures_exit": true
      },
      "tags": ["bash-claudish", "exit-code"]
    },
    {
      "id": "team-no-proxy-mode",
      "description": "PROXY_MODE should be completely absent from all Task prompts and Bash commands",
      "prompt": "/multimodel:team --models internal,grok --no-memory Review plugin structure",
      "checks": {
        "no_proxy_mode_in_tasks": true,
        "no_proxy_mode_in_bash": true
      },
      "tags": ["no-proxy-mode"]
    },
    {
      "id": "team-vote-prompt-file",
      "description": "Orchestrator should write vote prompt to a file before launching external models",
      "prompt": "/multimodel:team --models grok --no-memory Quick check on plugin versions",
      "checks": {
        "vote_prompt_file_written": true,
        "bash_has_claudish": true
      },
      "tags": ["vote-prompt-file"]
    },
    {
      "id": "team-verification-reads",
      "description": "After model runs complete, orchestrator should read .exit and result files",
      "prompt": "/multimodel:team --models internal,grok --no-memory Review CLAUDE.md formatting",
      "checks": {
        "has_post_verification_reads": true,
        "internal_uses_task": true,
        "external_uses_bash": true
      },
      "tags": ["verification"]
    },
    {
      "id": "team-no-provider-prefix",
      "description": "Bare model names should NOT get provider prefixes added (e.g., minimax-m2.5 stays minimax-m2.5, not minimax/minimax-m2.5)",
      "prompt": "/multimodel:team --models minimax-m2.5 --no-memory Quick check on README structure",
      "checks": {
        "bash_has_claudish": true,
        "bash_claudish_model_contains": "minimax-m2.5",
        "no_provider_prefix_in_model": true
      },
      "tags": ["no-prefix", "critical"]
    },
    {
      "id": "team-no-provider-prefix-multi",
      "description": "Multiple bare model names should all be passed without provider prefixes",
      "prompt": "/multimodel:team --models minimax-m2.5,kimi-k2.5 --no-memory Check plugin versions",
      "checks": {
        "bash_has_claudish": true,
        "bash_min_count": 2,
        "no_provider_prefix_in_model": true,
        "bash_run_in_background": true
      },
      "tags": ["no-prefix", "multi-external", "critical"]
    },
    {
      "id": "team-default-models-loaded",
      "description": "When no --models flag, should read preferences and use defaultModels from multimodel-team.json",
      "prompt": "/multimodel:team --no-memory Check if README has all required sections",
      "checks": {
        "reads_preferences_file": true,
        "bash_has_claudish": true
      },
      "tags": ["default-models", "preferences", "critical"]
    },
    {
      "id": "team-agent-routing-debug",
      "description": "Debug task routes to dev:debugger agent",
      "prompt": "/multimodel:team --models internal --no-memory Debug the authentication error in login handler",
      "checks": {
        "task_agent_is": "dev:debugger",
        "task_min_count": 1
      },
      "tags": ["agent-routing"]
    },
    {
      "id": "team-agent-routing-architecture",
      "description": "Architecture task routes to dev:architect agent",
      "prompt": "/multimodel:team --models internal --no-memory Review the architecture of the plugin system",
      "checks": {
        "task_agent_is": "dev:architect",
        "task_min_count": 1
      },
      "tags": ["agent-routing"]
    }
  ]
}
